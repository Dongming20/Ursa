# URSA

Release version: 1.0

URSA is an electronic structure code that uses a real-space Finite Element Method (FEM) discretization to perform GW approximation calculations using all-electron ground-state DFT or Hartree-Fock as the starting points. The code is taking advantage of the state-of-the-art FEAST [1,2] as the non-linear eigenvalue solver for the GW quasiparticle equations [3]. URSA is an extension of an 3D FEM legacy code - NESSIE [4]. The real space mesh is generated using the software tetgen [5]. Remark 1: Current atom database is limited to two rows of the periodic table (but it is easy to add more); Only isolated systems (non-periodic) are considered in this release (no bandsructrure calculations). Remark 2: Fully analytic method (by solving the Casida equation) of G0W0@DFT and G0W0@HF are included in this current URSA release, while non-linear eigenvalue solver for G0W0 will be added in the next release.

[1] [Eric Polizzi, "Density-Matrix-Based Algorithms for Solving Eigenvalue Problems", Phys. Rev. B. Vol. 79, 115112, 2009](https://journals.aps.org/prb/abstract/10.1103/PhysRevB.79.115112)

[2] [FEAST Eigenvalue Solver](http://www.feast-solver.org/)

[3] [Dongming Li and Eric Polizzi, "Nonlinear eigenvalue algorithm for GW quasiparticle equations",Phys. Rev. B. Vol 111, 045137, 2025](https://journals.aps.org/prb/abstract/10.1103/PhysRevB.111.045137)

[4] [NESSIE](http://www.nessie-code.org/)

[5] [Tetgen](https://wias-berlin.de/software/index.jsp?id=TetGen)



## Installation

__1__- Install the Intel-MKL library.

__2__- Install the [FEAST library](http://www.feast-solver.org/) (BSD License)--see corresponding installation instructions.

__3__- Install the [Tetgen library](https://wias-berlin.de/software/index.jsp?id=TetGen) (GNU-GPL License)-- install the executable __tetgen__ in your PATH or copy it in the /bin URSA directory.

__4__- Installation of [LibXC library](https://libxc.gitlab.io/) is optional. Please make sure it is compiled with the same compiler. Without LibXC, only LDA XC functional of DFT is supported. 

__5__- Deﬁne the Shell variable URSAROOT, e.g. export URSAROOT=<URSA directory> or set URSAROOT=<URSA directory> respectively for the BASH or CSH shells.
One of this command can be placed in the appropriate shell startup ﬁle in $HOME (i.e .bashrc or .cshrc).

__6__- In your shell startup file you also need to include this line (using BASH shell): export PATH="$URSAROOT/bin:$PATH"

__7__- Navigate to the /src directory and execute

```bash
make all
```
By default, the compilation is using ifx and intel MPI. If you wish to use a different compiler or MPI directives, just enter "__make__" to see all the possible options.

__8__- done


## Usage and Example

__1__- Create a standard .xyz atomic file which contains the atoms and their coordinates in Angstrum. The /simulations directory contains multiple sub-directories with their
example xyz files:


__He__ for Helium,  __H2__ for diHydrogen, __CO__ for Carbon Monoxide, __H2O__  for Water, __N2__ for Nitrogen molecule, etc

In the following, let us take the example of __H2__.

__2__- To run G0W0 simulations, we need to create the input file: __H2.gw__
This input file can be automatically generated by executing (for example):
```bash
ursa_configure H2 dft cd p2
```
Here:

-__dft__ stands for DFT simulations (!Options: dft, hf),

-__cd__ stands for the Contour-Deformation calculation method for the GW self-energy (Options: cd, casida, none (no GW)),

-__p2__ stands for P2-FEM real-space mesh discretization (p3 is also available for higher accuracy). We note that running G0W0 with p2 provides good enough results for the HOMO energies.

Before executing the G0W0 simulations, you can edit the file __H2.gw__ and change various options. Many of the these options are self-explanatory (such as p2 vs p3) but many others are expert options. A comprehensive URSA documentation is not yet available. 

__3__- After executing the __ursa_configure__ file, the simulation can be run using the following line
```bash
ursa_compute H2
```


Many information will be displayed on screen during the G0W0 calculations. Here is the screenshot of some results. The last list of (two columns) numbers are the correlation energies ($<\psi_{KS}^{HOMO}|\Sigma_c(\omega)|\psi_{KS}^{HOMO}>$) in eV calculated by Fully analytic method with 20 (N_grid=20) energy grids -- between \[Emin=-17.5 eV, Emax=-14.5 eV\] for HOMO and \[Emin=0.0 eV, Emax=2.5 eV\] for LUMO.

```bash
 Nn -        4824 Ne -        3459
 # of occupied orbitals           1
  -------------------------------------------
 | compute initial guess of electron density |
 | & diagonalize Kohn-Sham equation          |
  -------------------------------------------
 ***
  ------------------------------------------
 |           SCF-iteration starts           |
  ------------------------------------------
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 SCF-Cycle ----           0
 --- Energy states up to occupied + LUMO (eV) ---
           1  -13.5149078487864     
           2 -0.473829703823662     
 SCF-loop residual -------   0.710946383567262     
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 SCF-Cycle ----           1
 --- Energy states up to occupied + LUMO (eV) ---
           1  -11.4351427683472     
           2  0.195670685870979     
 SCF-loop residual -------   0.177896496784516     
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 SCF-Cycle ----           2
 --- Energy states up to occupied + LUMO (eV) ---
           1  -10.2944669486597     
           2  0.594910282039306     
 SCF-loop residual -------   6.790097206182620E-003
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 SCF-Cycle ----           3
 --- Energy states up to occupied + LUMO (eV) ---
           1  -10.3329210034280     
           2  0.622038237781300     
 SCF-loop residual -------   6.502003753860067E-003
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 SCF-Cycle ----           4
 --- Energy states up to occupied + LUMO (eV) ---
           1  -10.2923983411776     
           2  0.632749382823823     
 SCF-loop residual -------   2.963865692976468E-004
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 SCF-Cycle ----           5
 --- Energy states up to occupied + LUMO (eV) ---
           1  -10.2936424638287     
           2  0.633297040565840     
 SCF-loop residual -------   3.636386426032526E-005
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 SCF-Cycle ----           6
 --- Energy states up to occupied + LUMO (eV) ---
           1  -10.2931752204160     
           2  0.633800423798081     
 SCF-loop residual -------   1.007039298800454E-005
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 SCF-Cycle ----           7
 --- Energy states up to occupied + LUMO (eV) ---
           1  -10.2930595692825     
           2  0.633863078015596     
 SCF-loop residual -------   5.116309719771090E-006
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 SCF-Cycle ----           8
 --- Energy states up to occupied + LUMO (eV) ---
           1  -10.2930988322457     
           2  0.633845488512944     
 SCF-loop residual -------   4.847564529970609E-007
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 SCF-Cycle ----           9
 --- Energy states up to occupied + LUMO (eV) ---
           1  -10.2930955794039     
           2  0.633847082803126     
 SCF-loop residual -------   1.929130475050312E-008
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 SCF-Cycle ----          10
 --- Energy states up to occupied + LUMO (eV) ---
           1  -10.2930954080327     
           2  0.633847174566831     
 SCF-loop residual -------   6.692170500381725E-009
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 Ground State Convergence Reached!!!
 ==============================================
 -----  Orbital,  E_kinetic (eV) -----
           1   15.0097451558960     
           2   5.80672466668347     
 -----  Orbital,  E_ext (eV) -----
           1  -48.6487199382248     
           2  -18.0997647952865     
 -----  Orbital,  E_h (eV) -----
           1   34.8498158476662     
           2   16.3729535323026     
 -----  Orbital,  E_x (eV) -----
           1  -10.0464411301152     
           2  -2.78711709532976     
 -----  Orbital,      E_c (eV) -----
           1  -1.45749534325477     
           2 -0.658949133802951     
 ==============================================
 --- solve all unoccupied states ---
  
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 !!!!!!!!!!!!!  GW starts  !!!!!!!!!!!!!!!
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 *** allocate memory for GW calculations ***
 *** construct bare Coulomb potential -- 1/|r-r'| ***
 *** construct GW Exchange Self-energy -- Sigma_x ***
 ==============================================
 ----  Orbital,  GW <psi|Sigma_x|psi> (eV) ----
           1  -17.5663306637352     
           2  -1.02042477483526     
 ==============================================
 *** compute Casida Kx ***
 *** construct Casida matrix  ***
 *** solve Casida eigenvalue equation  ***
 ==========
 *** solve orbital           1  -- Sigma_c  ***
   energy grid (eV)     GW <psi|Sigma_c|psi> (eV)
  -17.5000000000000       0.795134657964793     
  -17.3421052631579       0.746329188026123     
  -17.1842105263158       0.699661558938012     
  -17.0263157894737       0.654957921809014     
  -16.8684210526316       0.612063702384820     
  -16.7105263157895       0.570840922989502     
  -16.5526315789474       0.531165964880904     
  -16.3947368421053       0.492927688186589     
  -16.2368421052632       0.456025843991710     
  -16.0789473684211       0.420369726538108     
  -15.9210526315789       0.385877023869741     
  -15.7631578947368       0.352472833359203     
  -15.6052631578947       0.320088814915959     
  -15.4473684210526       0.288662459712073     
  -15.2894736842105       0.258136456268683     
  -15.1315789473684       0.228458138954174     
  -14.9736842105263       0.199579006526933     
  -14.8157894736842       0.171454300444745     
  -14.6578947368421       0.144042634361712     
  -14.5000000000000       0.117305667621887     
 *** solve orbital           2  -- Sigma_c  ***
   energy grid (eV)     GW <psi|Sigma_c|psi> (eV)
  0.000000000000000E+000 -0.356979656590720     
  0.131578947368421      -0.359686901821617     
  0.263157894736842      -0.362412408906082     
  0.394736842105263      -0.365156757304678     
  0.526315789473684      -0.367920541310062     
  0.657894736842105      -0.370704370802304     
  0.789473684210526      -0.373508872044030     
  0.921052631578947      -0.376334688518317     
   1.05263157894737      -0.379182481812475     
   1.18421052631579      -0.382052932551066     
   1.31578947368421      -0.384946741381866     
   1.44736842105263      -0.387864630018730     
   1.57894736842105      -0.390807342345682     
   1.71052631578947      -0.393775645586945     
   1.84210526315789      -0.396770331548027     
   1.97368421052632      -0.399792217933446     
   2.10526315789474      -0.402842149747167     
   2.23684210526316      -0.405921000782431     
   2.36842105263158      -0.409029675208256     
   2.50000000000000      -0.412169109260568
```

Eigenvectors are all saved in output files. The code is also generating a mesh point .vtk file that can be used for plotting the ground state density and potential.



## License
[BSD](https://opensource.org/licenses/BSD-3-Clause)
The URSA code is distributed under the BSD software license.

Copyright (c) 2022-2025, The Regents of the University of Massachusetts, Amherst.
Dongming Li
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
3. Neither the name of the University nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
